<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload</title>
</head>
<body>
    <h2>Upload a File</h2>
    <form action="" method="POST" enctype="multipart/form-data">
        <input type="file" name="file" required />
        <input type="submit" value="Upload" />
    </form>

    <?php
    // Check if the form has been submitted
    if ($_SERVER['REQUEST_METHOD'] == 'POST') {
        // Check if a file was uploaded
        if (isset($_FILES['file'])) {
            $errors = array();
            $file_name = $_FILES['file']['name'];
            $file_size = $_FILES['file']['size'];
            $file_tmp = $_FILES['file']['tmp_name'];
            $file_type = $_FILES['file']['type'];

            // Get the file extension
            $file_ext = strtolower(pathinfo($file_name, PATHINFO_EXTENSION));

            // Allowed file extensions
            $extensions = array("jpeg", "jpg", "png", "gif", "pdf", "doc", "docx");

            // Validate file extension
            if (!in_array($file_ext, $extensions)) {
                $errors[] = "Extension not allowed, please choose a JPEG, PNG, GIF, PDF, or DOC file.";
            }

            // Validate file size (limit to 2MB)
            if ($file_size > 2097152) {
                $errors[] = 'File size must be less than 2 MB';
            }

            // If no errors, move the uploaded file
            if (empty($errors)) {
                // Create uploads directory if it doesn't exist
                if (!is_dir('uploads')) {
                    mkdir('uploads', 0755, true);
                }

                // Move the file to the uploads directory
                if (move_uploaded_file($file_tmp, "uploads/" . $file_name)) {
                    echo "Success! File uploaded.";
                } else {
                    echo "Error uploading the file.";
                }
            } else {    
                // Print errors
                foreach ($errors as $error) {
                    echo "<p style='color:red;'>$error</p>";
                }
            }
        }
    }
    ?>
</body>
</html>